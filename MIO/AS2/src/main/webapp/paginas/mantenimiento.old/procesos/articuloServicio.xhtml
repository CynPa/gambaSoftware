<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">
<ui:composition template="/template/template.xhtml">

	<ui:define name="contenido">
		<h:form prependId="false">

			<p:outputPanel id="panelContenedor">

				<ui:include src="/template/barra.xhtml">
					<ui:param name="bean" value="#{articuloServicioBean}" />
				</ui:include>

				<p:outputPanel autoUpdate="true">
					<p:growl id="mensajes" showDetail="true" />
				</p:outputPanel>


				<p:dialog header="#{msgs.lbl_listado} #{msgs.lbl_articulo_servicio}"
					widgetVar="articuloServicioDialog" modal="true" height="300"
					width="1000" showEffect="slide" hideEffect="slide">

					<p:fieldset>

						<p:outputPanel id="panelEdicionCreacionArticuloHijo">
							<h:panelGrid id="panelEdicionCreacionHijo"
								columns="#{articuloServicioBean.numeroColumnasPanelNuevo}"
								columnClasses="columnaEtiqueta,columnaValor,columnaEtiqueta,columnaValor">

								<h:outputText value="#{msgs.lbl_codigo}:" />
								<p:inputText styleClass="input-text"
									value="#{articuloServicioBean.historicoArticuloServicio.articuloServicioHijo.codigo}"
									id="txtCodigo" />

								<h:outputText value="#{msgs.lbl_nombre}:" />
								<p:inputText styleClass="input-text"
									value="#{articuloServicioBean.historicoArticuloServicio.articuloServicioHijo.nombre}"
									id="txtNombre" />

								<h:outputText value="#{msgs.lbl_descripcion}:" />
								<p:inputTextarea styleClass="input-text"
									value="#{articuloServicioBean.historicoArticuloServicio.articuloServicioHijo.descripcion}"
									id="txtDescripcion" />


								<h:outputText value="#{msgs.lbl_tipo_articulo_servicio}:" />
								<h:panelGroup>
									<p:selectOneMenu
										value="#{articuloServicioBean.historicoArticuloServicio.articuloServicioHijo.tipoArticuloServicio}"
										id="cboTipoArticuloServicio" required="true">
										<f:selectItem itemValue="" itemLabel="#{msgs.lbl_seleccione}" />
										<f:selectItems
											value="#{articuloServicioBean.listaTipoArticuloServicio}" />

										<f:validateBean />
									</p:selectOneMenu>
									<p:message for="cboTipoArticuloServicio" />
								</h:panelGroup>

								<h:outputText value="#{msgs.lbl_categoria_articulo_servicio}:" />
								<h:panelGroup>
									<p:selectOneMenu
										value="#{articuloServicioBean.historicoArticuloServicio.articuloServicioHijo.categoriaArticuloServicio}"
										id="cboCategoriaArticuloServicio" required="true">
										<f:selectItem itemValue="" itemLabel="#{msgs.lbl_seleccione}" />
										<f:selectItems
											value="#{articuloServicioBean.listaCategoriaArticuloServicio}"
											var="_categoriaArticuloServicio"
											itemValue="#{_categoriaArticuloServicio}"
											itemLabel="#{_categoriaArticuloServicio.nombre}">
										</f:selectItems>
										<f:validateBean />
									</p:selectOneMenu>
									<p:message for="cboCategoriaArticuloServicio" />
								</h:panelGroup>

								<h:outputText value="#{msgs.lbl_grupo_articulo_servicio}:" />
								<h:panelGroup>
									<p:selectOneMenu
										value="#{articuloServicioBean.historicoArticuloServicio.articuloServicioHijo.grupoArticuloServicio}"
										id="cboGrupoArticuloServicio" required="true">
										<f:selectItem itemValue="" itemLabel="#{msgs.lbl_seleccione}" />
										<f:selectItems
											value="#{articuloServicioBean.listaGrupoArticuloServicio}"
											var="_grupoArticuloServicio"
											itemValue="#{_grupoArticuloServicio}"
											itemLabel="#{_grupoArticuloServicio.nombre}">
										</f:selectItems>
										<f:validateBean />
									</p:selectOneMenu>
									<p:message for="cboGrupoArticuloServicio" />
								</h:panelGroup>

								<h:outputText value="#{msgs.lbl_tipo_ciclo_operacion}:" />
								<h:panelGroup>
									<p:selectOneMenu
										value="#{articuloServicioBean.historicoArticuloServicio.articuloServicioHijo.tipoCicloOperacion}"
										id="cboTipoCicloOperacion" required="true">
										<f:selectItem itemValue="" itemLabel="#{msgs.lbl_seleccione}" />
										<f:selectItems
											value="#{articuloServicioBean.listaTipoCicloOperacion}"
											var="_tipoCicloOperacion" itemValue="#{_tipoCicloOperacion}"
											itemLabel="#{_tipoCicloOperacion.nombre}">
										</f:selectItems>
										<f:validateBean />
									</p:selectOneMenu>
									<p:message for="cboTipoCicloOperacion" />
								</h:panelGroup>

								<h:outputText value="#{msgs.lbl_vida_util} " />
								<p:inputText styleClass="input-text" id="txtVidaUtil"
									value="#{articuloServicioBean.historicoArticuloServicio.articuloServicioHijo.vitaUtil}">
									<f:validateBean />
								</p:inputText>

								<h:outputText value="#{msgs.lbl_numero_parte}:" />
								<p:inputText styleClass="input-text"
									value="#{articuloServicioBean.historicoArticuloServicio.articuloServicioHijo.numeroParte}"
									id="txtNumeroParte" />

								<h:outputText value="#{msgs.lbl_numero_serie}:" />
								<p:inputText styleClass="input-text"
									value="#{articuloServicioBean.historicoArticuloServicio.articuloServicioHijo.numeroSerie}"
									id="txtNumeroSerie" />

								<h:outputText value="#{msgs.lbl_codigo_barras}:" />
								<p:inputText styleClass="input-text"
									value="#{articuloServicioBean.historicoArticuloServicio.articuloServicioHijo.codigoBarras}"
									id="txtCodigoBarras" />

								<h:outputText value="#{msgs.lbl_fecha_desde}:" />
								<p:calendar
									value="#{articuloServicioBean.historicoArticuloServicio.fechaDesde}"
									pattern="#{articuloServicioBean.formatoFecha}" />

								<h:outputText value="#{msgs.lbl_hora_desde}:" />
								<p:calendar
									value="#{articuloServicioBean.historicoArticuloServicio.horaDesde}"
									pattern="HH:mm" minHour="8" maxHour="20" timeOnly="true" />
							</h:panelGrid>
						</p:outputPanel>
					</p:fieldset>
					<p:separator />
					<center>
						<p:commandButton value="#{msgs.btn_guardar}"
							process="@this, panelEdicionCreacionArticuloHijo"
							oncomplete="validacionesModal(xhr, status, args, articuloServicioDialog)"
							update="panelDetalleHistoricoArticulo" />
					</center>



				</p:dialog>

				<p:separator />

				<p:confirmDialog message="#{msgs.confirmacion_msg}? " width="200"
					modal="true" showEffect="explode" hideEffect="explode"
					severity="alert" widgetVar="confirmacionEliminar">

					<h:outputText
						value="#{articuloServicioBean.articuloServicio.nombre}" />

					<p:commandButton value="#{msgs.confirmacion_si}"
						update="tablaArticuloServicio,mensajes" process="@this"
						actionListener="#{articuloServicioBean.eliminar}"
						oncomplete="confirmacionEliminar.hide()" />

					<p:commandButton value="#{msgs.confirmacion_no}"
						onclick="confirmacionEliminar.hide()" />
				</p:confirmDialog>



				<p:outputPanel id="panelNuevo">

					<p:panel rendered="#{articuloServicioBean.editado}"
						header="#{msgs.lbl_panel_edicion} #{msgs.lbl_articulo_servicio}">


						<p:spacer width="2px" />

						<p:fieldset>

							<p:outputPanel id="panelDetalleHistoricoArticulo">

								<h:panelGrid id="panelDetalle"
									columns="#{articuloServicioBean.numeroColumnasPanelNuevo}"
									columnClasses="columnaEtiqueta,columnaValor,columnaEtiqueta,columnaValor">

									<h:outputText value="#{msgs.lbl_codigo}:" />
									<p:inputText styleClass="input-text"
										value="#{articuloServicioBean.articuloServicio.codigo}"
										id="txtCodigoPadre" />

									<h:outputText value="#{msgs.lbl_nombre}:" />
									<p:inputText styleClass="input-text"
										value="#{articuloServicioBean.articuloServicio.nombre}"
										id="txtNombrePadre" />

									<h:outputText value="#{msgs.lbl_descripcion}:" />
									<p:inputTextarea styleClass="input-text"
										value="#{articuloServicioBean.articuloServicio.descripcion}"
										id="txtDescripcionPadre" />

									<h:outputText value="#{msgs.lbl_grupo_articulo_servicio}:" />
									<h:panelGroup>
										<p:selectOneMenu
											value="#{articuloServicioBean.articuloServicio.grupoArticuloServicio}"
											id="cboGrupoArticuloServicioPadre" required="true">
											<f:selectItem itemValue="" itemLabel="#{msgs.lbl_seleccione}" />
											<f:selectItems
												value="#{articuloServicioBean.listaGrupoArticuloServicio}"
												var="_grupoArticuloServicio"
												itemValue="#{_grupoArticuloServicio}"
												itemLabel="#{_grupoArticuloServicio.nombre}">
											</f:selectItems>
											<f:validateBean />
										</p:selectOneMenu>
										<p:message for="cboGrupoArticuloServicioPadre" />
									</h:panelGroup>


									<h:outputText value="#{msgs.lbl_categoria_articulo_servicio}:" />
									<h:panelGroup>
										<p:selectOneMenu
											value="#{articuloServicioBean.articuloServicio.categoriaArticuloServicio}"
											id="cboCategoriaArticuloServicioPadre" required="true">
											<f:selectItem itemValue="" itemLabel="#{msgs.lbl_seleccione}" />
											<f:selectItems
												value="#{articuloServicioBean.listaCategoriaArticuloServicio}"
												var="_categoriaArticuloServicio"
												itemValue="#{_categoriaArticuloServicio}"
												itemLabel="#{_categoriaArticuloServicio.nombre}">
											</f:selectItems>
											<f:validateBean />
										</p:selectOneMenu>
										<p:message for="cboCategoriaArticuloServicioPadre" />
									</h:panelGroup>

									<h:outputText value="#{msgs.lbl_tipo_ciclo_operacion}:" />
									<h:panelGroup>
										<p:selectOneMenu
											value="#{articuloServicioBean.articuloServicio.tipoCicloOperacion}"
											id="cboTipoCicloOperacionPadre" required="true">
											<f:selectItem itemValue="" itemLabel="#{msgs.lbl_seleccione}" />
											<f:selectItems
												value="#{articuloServicioBean.listaTipoCicloOperacion}"
												var="_tipoCicloOperacion" itemValue="#{_tipoCicloOperacion}"
												itemLabel="#{_tipoCicloOperacion.nombre}">
											</f:selectItems>
											<f:validateBean />
										</p:selectOneMenu>
										<p:message for="cboTipoCicloOperacionPadre" />
									</h:panelGroup>

									<h:outputText value="#{msgs.lbl_vida_util} (#{msgs.lbl_meses})" />
									<p:inputText styleClass="input-text" id="txtVidaUtilPadre"
										value="#{articuloServicioBean.articuloServicio.vitaUtil}">
										<f:validateBean />
									</p:inputText>

									<h:outputText value="#{msgs.lbl_numero_parte}:" />
									<p:inputText styleClass="input-text"
										value="#{articuloServicioBean.articuloServicio.numeroParte}"
										id="txtNumeroPartePadre" />

									<h:outputText value="#{msgs.lbl_numero_serie}:" />
									<p:inputText styleClass="input-text"
										value="#{articuloServicioBean.articuloServicio.numeroSerie}"
										id="txtNumeroSeriePadre" />

									<h:outputText value="#{msgs.lbl_codigo_barras}:" />
									<p:inputText styleClass="input-text"
										value="#{articuloServicioBean.articuloServicio.codigoBarras}"
										id="txtCodigoBarrasPadre" />
								</h:panelGrid>


								<p:treeTable id="arbol"
									value="#{articuloServicioBean.nodoPrincipal}" var="_nodo"
									selectionMode="single"
									selection="#{articuloServicioBean.nodoSeleccionado}">

									<p:column>
										<f:facet name="header">
											<h:outputText value="#{msgs.lbl_nombre}" />
										</f:facet>
										<h:outputText value="#{_nodo.articuloServicioHijo.nombre}" />
									</p:column>

									<p:column>
										<f:facet name="header">
											<h:outputText value="#{msgs.lbl_fecha_desde}" />
										</f:facet>

										<h:outputText value="#{_nodo.fechaDesde}">
											<f:convertDateTime
												pattern="#{articuloServicioBean.formatoFecha}" />
										</h:outputText>
									</p:column>

									<p:column>
										<f:facet name="header">
											<h:outputText value="#{msgs.lbl_hora_desde}" />
										</f:facet>
										<h:outputText value="#{_nodo.horaDesde}">
											<f:convertDateTime pattern="HH:mm" />
										</h:outputText>
									</p:column>
									<p:column>
										<f:facet name="header">
											<h:outputText value="#{msgs.lbl_fecha_hasta}" />
										</f:facet>
										<h:outputText value="#{_nodo.fechaHasta}">
											<f:convertDateTime
												pattern="#{articuloServicioBean.formatoFecha}" />
										</h:outputText>
									</p:column>

									<p:column>
										<f:facet name="header">
											<h:outputText value="#{msgs.lbl_hora_hasta}" />
										</f:facet>

										<h:outputText value="#{_nodo.horaHasta}">
											<f:convertDateTime pattern="HH:mm" />
										</h:outputText>
									</p:column>

								</p:treeTable>

								<h:panelGrid columns="2">
									<p:commandButton value="#{msgs.btn_editar}"
										actionListener="#{articuloServicioBean.seleccionarHistoricoArticulo}"
										process="@this panelDetalleHistoricoArticulo"
										update="panelEdicionCreacionArticuloHijo"
										oncomplete="articuloServicioDialog.show();" />

									<p:commandButton value="#{msgs.btn_nuevo}"
										action="#{articuloServicioBean.agregarArticulo}"
										process="@this panelDetalleHistoricoArticulo"
										update="panelEdicionCreacionArticuloHijo"
										oncomplete="articuloServicioDialog.show();" />

								</h:panelGrid>
							</p:outputPanel>
						</p:fieldset>

					</p:panel>

				</p:outputPanel>

				<p:outputPanel id="panelListado">

					<p:panel rendered="#{!articuloServicioBean.editado}"
						header="#{msgs.lbl_panel_listado} #{msgs.lbl_articulo_servicio}">

						<p:dataTable filterDelay="#{sesionControler.retrasoFiltro}" id="tablaArticuloServicio" rowIndexVar="secuencia"
							emptyMessage="#{msgs.msg_no_hay_datos}"
							value="#{articuloServicioBean.listaArticuloServicio}"
							var="_articulo_servicio"
							binding="#{articuloServicioBean.dtArticuloServicio}"
							paginator="true" paginatorPosition="bottom" style="width:100%"
							rows="#{articuloServicioBean.numeroFilas}"
							rowsPerPageTemplate="#{articuloServicioBean.numeroFilasPorPagina}"
							selection="#{articuloServicioBean.articuloServicio}"
							selectionMode="single" rowKey="#{_articulo_servicio.id}">

							<p:column headerText="Nº">
								<h:outputText value="#{secuencia+1}" />
							</p:column>

							<p:column filterBy="#{_articulo_servicio.codigo}"
								sortBy="#{_articulo_servicio.codigo}">
								<f:facet name="header">
									<h:outputText value="#{msgs.lbl_codigo}" />
								</f:facet>
								<h:outputText value="#{_articulo_servicio.codigo}" />
							</p:column>

							<p:column filterBy="#{_articulo_servicio.nombre}"
								sortBy="#{_articulo_servicio.nombre}">
								<f:facet name="header">
									<h:outputText value="#{msgs.lbl_nombre}" />
								</f:facet>
								<h:outputText value="#{_articulo_servicio.nombre}" />
							</p:column>

							<p:column sortBy="#{_articulo_servicio.descripcion}">
								<f:facet name="header">
									<h:outputText value="#{msgs.lbl_descripcion}" />
								</f:facet>
								<h:outputText value="#{_articulo_servicio.descripcion}" />
							</p:column>

						</p:dataTable>
					</p:panel>

					<p:separator />

					<ui:include src="/template/auditoriaRapida.xhtml">
						<ui:param name="fechaCreacion"
							value="#{articuloServicioBean.articuloServicio.fechaCreacion}" />
						<ui:param name="usuarioCreacion"
							value="#{articuloServicioBean.articuloServicio.usuarioCreacion}" />
						<ui:param name="fechaModificacion"
							value="#{articuloServicioBean.articuloServicio.fechaModificacion}" />
						<ui:param name="usuarioModificacion"
							value="#{articuloServicioBean.articuloServicio.usuarioModificacion}" />
					</ui:include>

				</p:outputPanel>
			</p:outputPanel>
		</h:form>
	</ui:define>
</ui:composition>
</html>